[
    ClassDefinition {
        name: Span {
            str: "Connection",
            start: 6,
            end: 16,
        },
        generics: [],
        members: [
            Variable {
                name: Span {
                    str: "event",
                    start: 18,
                    end: 23,
                },
                kind: Type {
                    base: Identifier(
                        Span {
                            str: "Event",
                            start: 25,
                            end: 30,
                        },
                    ),
                    generics: [],
                    array: false,
                    raw: false,
                    span: Span {
                        str: "Event",
                        start: 25,
                        end: 30,
                    },
                },
                default_value: Empty,
                span: Span {
                    str: "event: Event;",
                    start: 18,
                    end: 31,
                },
            },
            Variable {
                name: Span {
                    str: "id",
                    start: 33,
                    end: 35,
                },
                kind: Type {
                    base: Identifier(
                        Span {
                            str: "int",
                            start: 37,
                            end: 40,
                        },
                    ),
                    generics: [],
                    array: false,
                    raw: false,
                    span: Span {
                        str: "int",
                        start: 37,
                        end: 40,
                    },
                },
                default_value: Empty,
                span: Span {
                    str: "id: int;",
                    start: 33,
                    end: 41,
                },
            },
            Function {
                name: Span {
                    str: "new",
                    start: 65,
                    end: 68,
                },
                attributes: Some(
                    ClassFunctionAttributes {
                        attributes: [
                            Constructor(
                                Span {
                                    str: "constructor",
                                    start: 46,
                                    end: 57,
                                },
                            ),
                        ],
                        span: Span {
                            str: "#[constructor]",
                            start: 44,
                            end: 58,
                        },
                    },
                ),
                generics: [],
                arguments: [
                    FunctionArgument {
                        name: Identifier(
                            Span {
                                str: "event",
                                start: 69,
                                end: 74,
                            },
                        ),
                        kind: Type {
                            base: Identifier(
                                Span {
                                    str: "Event",
                                    start: 76,
                                    end: 81,
                                },
                            ),
                            generics: [],
                            array: false,
                            raw: false,
                            span: Span {
                                str: "Event",
                                start: 76,
                                end: 81,
                            },
                        },
                        span: Span {
                            str: "event: Event",
                            start: 69,
                            end: 81,
                        },
                    },
                    FunctionArgument {
                        name: Identifier(
                            Span {
                                str: "id",
                                start: 83,
                                end: 85,
                            },
                        ),
                        kind: Type {
                            base: Identifier(
                                Span {
                                    str: "int",
                                    start: 87,
                                    end: 90,
                                },
                            ),
                            generics: [],
                            array: false,
                            raw: false,
                            span: Span {
                                str: "int",
                                start: 87,
                                end: 90,
                            },
                        },
                        span: Span {
                            str: "id: int",
                            start: 83,
                            end: 90,
                        },
                    },
                ],
                return_type: Some(
                    Type {
                        base: Identifier(
                            Span {
                                str: "this",
                                start: 95,
                                end: 99,
                            },
                        ),
                        generics: [],
                        array: false,
                        raw: false,
                        span: Span {
                            str: "this ",
                            start: 95,
                            end: 100,
                        },
                    },
                ),
                statements: [
                    VariableAssign {
                        name: DotAccess {
                            expression: Identifier(
                                Span {
                                    str: "this",
                                    start: 105,
                                    end: 109,
                                },
                            ),
                            accessor: Identifier(
                                Span {
                                    str: "event",
                                    start: 110,
                                    end: 115,
                                },
                            ),
                            span: Span {
                                str: ".event",
                                start: 109,
                                end: 115,
                            },
                        },
                        value: Identifier(
                            Span {
                                str: "event",
                                start: 118,
                                end: 123,
                            },
                        ),
                        span: Span {
                            str: "this.event = event;",
                            start: 105,
                            end: 124,
                        },
                    },
                    VariableAssign {
                        name: DotAccess {
                            expression: Identifier(
                                Span {
                                    str: "this",
                                    start: 127,
                                    end: 131,
                                },
                            ),
                            accessor: Identifier(
                                Span {
                                    str: "id",
                                    start: 132,
                                    end: 134,
                                },
                            ),
                            span: Span {
                                str: ".id",
                                start: 131,
                                end: 134,
                            },
                        },
                        value: Identifier(
                            Span {
                                str: "id",
                                start: 137,
                                end: 139,
                            },
                        ),
                        span: Span {
                            str: "this.id = id;",
                            start: 127,
                            end: 140,
                        },
                    },
                ],
                span: Span {
                    str: "func new(event: Event, id: int) -> this do\n\t\tthis.event = event;\n\t\tthis.id = id;\n\tend\n\n\t",
                    start: 60,
                    end: 148,
                },
            },
            Function {
                name: Span {
                    str: "disconnect",
                    start: 153,
                    end: 163,
                },
                attributes: None,
                generics: [],
                arguments: [],
                return_type: None,
                statements: [
                    FunctionCall {
                        callee: DotAccess {
                            expression: DotAccess {
                                expression: Identifier(
                                    Span {
                                        str: "this",
                                        start: 171,
                                        end: 175,
                                    },
                                ),
                                accessor: Identifier(
                                    Span {
                                        str: "event",
                                        start: 176,
                                        end: 181,
                                    },
                                ),
                                span: Span {
                                    str: ".event",
                                    start: 175,
                                    end: 181,
                                },
                            },
                            accessor: Identifier(
                                Span {
                                    str: "_disconnect",
                                    start: 182,
                                    end: 193,
                                },
                            ),
                            span: Span {
                                str: "._disconnect",
                                start: 181,
                                end: 193,
                            },
                        },
                        generics: [],
                        arguments: [
                            DotAccess {
                                expression: Identifier(
                                    Span {
                                        str: "this",
                                        start: 194,
                                        end: 198,
                                    },
                                ),
                                accessor: Identifier(
                                    Span {
                                        str: "id",
                                        start: 199,
                                        end: 201,
                                    },
                                ),
                                span: Span {
                                    str: ".id",
                                    start: 198,
                                    end: 201,
                                },
                            },
                        ],
                        span: Span {
                            str: "(this.id)",
                            start: 193,
                            end: 202,
                        },
                    },
                ],
                span: Span {
                    str: "func disconnect() do\n\t\tthis.event._disconnect(this.id);\n\tend\n",
                    start: 148,
                    end: 209,
                },
            },
        ],
        span: Span {
            str: "class Connection\n\tevent: Event;\n\tid: int;\n\n\t#[constructor]\n\tfunc new(event: Event, id: int) -> this do\n\t\tthis.event = event;\n\t\tthis.id = id;\n\tend\n\n\tfunc disconnect() do\n\t\tthis.event._disconnect(this.id);\n\tend\nend\n\n",
            start: 0,
            end: 214,
        },
    },
    ClassDefinition {
        name: Span {
            str: "Event",
            start: 220,
            end: 225,
        },
        generics: [],
        members: [
            Variable {
                name: Span {
                    str: "name",
                    start: 227,
                    end: 231,
                },
                kind: Type {
                    base: Identifier(
                        Span {
                            str: "string",
                            start: 233,
                            end: 239,
                        },
                    ),
                    generics: [],
                    array: false,
                    raw: false,
                    span: Span {
                        str: "string",
                        start: 233,
                        end: 239,
                    },
                },
                default_value: Empty,
                span: Span {
                    str: "name: string;",
                    start: 227,
                    end: 240,
                },
            },
            Variable {
                name: Span {
                    str: "functions",
                    start: 242,
                    end: 251,
                },
                kind: Type {
                    base: Identifier(
                        Span {
                            str: "unknown",
                            start: 253,
                            end: 260,
                        },
                    ),
                    generics: [],
                    array: true,
                    raw: false,
                    span: Span {
                        str: "unknown[]",
                        start: 253,
                        end: 262,
                    },
                },
                default_value: Empty,
                span: Span {
                    str: "functions: unknown[];",
                    start: 242,
                    end: 263,
                },
            },
            Function {
                name: Span {
                    str: "new",
                    start: 287,
                    end: 290,
                },
                attributes: Some(
                    ClassFunctionAttributes {
                        attributes: [
                            Constructor(
                                Span {
                                    str: "constructor",
                                    start: 268,
                                    end: 279,
                                },
                            ),
                        ],
                        span: Span {
                            str: "#[constructor]",
                            start: 266,
                            end: 280,
                        },
                    },
                ),
                generics: [],
                arguments: [
                    FunctionArgument {
                        name: Identifier(
                            Span {
                                str: "name",
                                start: 291,
                                end: 295,
                            },
                        ),
                        kind: Type {
                            base: Identifier(
                                Span {
                                    str: "string",
                                    start: 297,
                                    end: 303,
                                },
                            ),
                            generics: [],
                            array: false,
                            raw: false,
                            span: Span {
                                str: "string",
                                start: 297,
                                end: 303,
                            },
                        },
                        span: Span {
                            str: "name: string",
                            start: 291,
                            end: 303,
                        },
                    },
                ],
                return_type: Some(
                    Type {
                        base: Identifier(
                            Span {
                                str: "this",
                                start: 308,
                                end: 312,
                            },
                        ),
                        generics: [],
                        array: false,
                        raw: false,
                        span: Span {
                            str: "this ",
                            start: 308,
                            end: 313,
                        },
                    },
                ),
                statements: [
                    VariableAssign {
                        name: DotAccess {
                            expression: Identifier(
                                Span {
                                    str: "this",
                                    start: 318,
                                    end: 322,
                                },
                            ),
                            accessor: Identifier(
                                Span {
                                    str: "name",
                                    start: 323,
                                    end: 327,
                                },
                            ),
                            span: Span {
                                str: ".name",
                                start: 322,
                                end: 327,
                            },
                        },
                        value: Identifier(
                            Span {
                                str: "name",
                                start: 330,
                                end: 334,
                            },
                        ),
                        span: Span {
                            str: "this.name = name;",
                            start: 318,
                            end: 335,
                        },
                    },
                ],
                span: Span {
                    str: "func new(name: string) -> this do\n\t\tthis.name = name;\n\tend\n\n\t",
                    start: 282,
                    end: 343,
                },
            },
            Function {
                name: Span {
                    str: "connect",
                    start: 348,
                    end: 355,
                },
                attributes: None,
                generics: [],
                arguments: [
                    FunctionArgument {
                        name: Identifier(
                            Span {
                                str: "function",
                                start: 356,
                                end: 364,
                            },
                        ),
                        kind: Type {
                            base: Identifier(
                                Span {
                                    str: "unknown",
                                    start: 366,
                                    end: 373,
                                },
                            ),
                            generics: [],
                            array: false,
                            raw: false,
                            span: Span {
                                str: "unknown",
                                start: 366,
                                end: 373,
                            },
                        },
                        span: Span {
                            str: "function: unknown",
                            start: 356,
                            end: 373,
                        },
                    },
                ],
                return_type: Some(
                    Type {
                        base: Identifier(
                            Span {
                                str: "Connection",
                                start: 378,
                                end: 388,
                            },
                        ),
                        generics: [],
                        array: false,
                        raw: false,
                        span: Span {
                            str: "Connection ",
                            start: 378,
                            end: 389,
                        },
                    },
                ),
                statements: [
                    VariableDefinition {
                        name: Span {
                            str: "connection",
                            start: 398,
                            end: 408,
                        },
                        kind: Empty,
                        value: FunctionCall {
                            callee: DotAccess {
                                expression: Identifier(
                                    Span {
                                        str: "Connection",
                                        start: 411,
                                        end: 421,
                                    },
                                ),
                                accessor: Identifier(
                                    Span {
                                        str: "new",
                                        start: 422,
                                        end: 425,
                                    },
                                ),
                                span: Span {
                                    str: ".new",
                                    start: 421,
                                    end: 425,
                                },
                            },
                            generics: [],
                            arguments: [
                                Identifier(
                                    Span {
                                        str: "this",
                                        start: 426,
                                        end: 430,
                                    },
                                ),
                            ],
                            span: Span {
                                str: "(this)",
                                start: 425,
                                end: 431,
                            },
                        },
                        span: Span {
                            str: "var connection = Connection.new(this);",
                            start: 394,
                            end: 432,
                        },
                    },
                    VariableAssign {
                        name: ArrayAccess {
                            expression: DotAccess {
                                expression: Identifier(
                                    Span {
                                        str: "this",
                                        start: 435,
                                        end: 439,
                                    },
                                ),
                                accessor: Identifier(
                                    Span {
                                        str: "functions",
                                        start: 440,
                                        end: 449,
                                    },
                                ),
                                span: Span {
                                    str: ".functions",
                                    start: 439,
                                    end: 449,
                                },
                            },
                            accessor: Binary {
                                lhs: DotAccess {
                                    expression: DotAccess {
                                        expression: Identifier(
                                            Span {
                                                str: "this",
                                                start: 450,
                                                end: 454,
                                            },
                                        ),
                                        accessor: Identifier(
                                            Span {
                                                str: "functions",
                                                start: 455,
                                                end: 464,
                                            },
                                        ),
                                        span: Span {
                                            str: ".functions",
                                            start: 454,
                                            end: 464,
                                        },
                                    },
                                    accessor: Identifier(
                                        Span {
                                            str: "length",
                                            start: 465,
                                            end: 471,
                                        },
                                    ),
                                    span: Span {
                                        str: ".length",
                                        start: 464,
                                        end: 471,
                                    },
                                },
                                operator: Plus,
                                rhs: Int(
                                    1,
                                    Span {
                                        str: "1",
                                        start: 474,
                                        end: 475,
                                    },
                                ),
                                span: Span {
                                    str: "this.functions.length + 1",
                                    start: 450,
                                    end: 475,
                                },
                            },
                            span: Span {
                                str: "[this.functions.length + 1]",
                                start: 449,
                                end: 476,
                            },
                        },
                        value: Identifier(
                            Span {
                                str: "function",
                                start: 479,
                                end: 487,
                            },
                        ),
                        span: Span {
                            str: "this.functions[this.functions.length + 1] = function;",
                            start: 435,
                            end: 488,
                        },
                    },
                    Return {
                        value: Identifier(
                            Span {
                                str: "connection",
                                start: 499,
                                end: 509,
                            },
                        ),
                        span: Span {
                            str: "return connection;",
                            start: 492,
                            end: 510,
                        },
                    },
                ],
                span: Span {
                    str: "func connect(function: unknown) -> Connection do\n\t\tvar connection = Connection.new(this);\n\t\tthis.functions[this.functions.length + 1] = function;\n\n\t\treturn connection;\n\tend\n\n\t",
                    start: 343,
                    end: 518,
                },
            },
            Function {
                name: Span {
                    str: "_disconnect",
                    start: 523,
                    end: 534,
                },
                attributes: None,
                generics: [],
                arguments: [
                    FunctionArgument {
                        name: Identifier(
                            Span {
                                str: "id",
                                start: 535,
                                end: 537,
                            },
                        ),
                        kind: Type {
                            base: Identifier(
                                Span {
                                    str: "int",
                                    start: 539,
                                    end: 542,
                                },
                            ),
                            generics: [],
                            array: false,
                            raw: false,
                            span: Span {
                                str: "int",
                                start: 539,
                                end: 542,
                            },
                        },
                        span: Span {
                            str: "id: int",
                            start: 535,
                            end: 542,
                        },
                    },
                ],
                return_type: None,
                statements: [
                    FunctionCall {
                        callee: DotAccess {
                            expression: DotAccess {
                                expression: Identifier(
                                    Span {
                                        str: "this",
                                        start: 549,
                                        end: 553,
                                    },
                                ),
                                accessor: Identifier(
                                    Span {
                                        str: "connections",
                                        start: 554,
                                        end: 565,
                                    },
                                ),
                                span: Span {
                                    str: ".connections",
                                    start: 553,
                                    end: 565,
                                },
                            },
                            accessor: Identifier(
                                Span {
                                    str: "remove",
                                    start: 566,
                                    end: 572,
                                },
                            ),
                            span: Span {
                                str: ".remove",
                                start: 565,
                                end: 572,
                            },
                        },
                        generics: [],
                        arguments: [
                            Identifier(
                                Span {
                                    str: "id",
                                    start: 573,
                                    end: 575,
                                },
                            ),
                        ],
                        span: Span {
                            str: "(id)",
                            start: 572,
                            end: 576,
                        },
                    },
                ],
                span: Span {
                    str: "func _disconnect(id: int) do\n\t\tthis.connections.remove(id);\n\tend\n\n\t",
                    start: 518,
                    end: 585,
                },
            },
            Function {
                name: Span {
                    str: "fire",
                    start: 590,
                    end: 594,
                },
                attributes: None,
                generics: [],
                arguments: [],
                return_type: None,
                statements: [
                    FunctionDefinition {
                        name: Span {
                            str: "call",
                            start: 607,
                            end: 611,
                        },
                        generics: [],
                        arguments: [
                            FunctionArgument {
                                name: Identifier(
                                    Span {
                                        str: "function",
                                        start: 612,
                                        end: 620,
                                    },
                                ),
                                kind: Type {
                                    base: Identifier(
                                        Span {
                                            str: "unknown",
                                            start: 622,
                                            end: 629,
                                        },
                                    ),
                                    generics: [],
                                    array: false,
                                    raw: false,
                                    span: Span {
                                        str: "unknown",
                                        start: 622,
                                        end: 629,
                                    },
                                },
                                span: Span {
                                    str: "function: unknown",
                                    start: 612,
                                    end: 629,
                                },
                            },
                        ],
                        return_type: None,
                        statements: [
                            FunctionCall {
                                callee: Identifier(
                                    Span {
                                        str: "function",
                                        start: 637,
                                        end: 645,
                                    },
                                ),
                                generics: [],
                                arguments: [],
                                span: Span {
                                    str: "()",
                                    start: 645,
                                    end: 647,
                                },
                            },
                        ],
                        span: Span {
                            str: "func call(function: unknown) do\n\t\t\tfunction();\n\t\tend\n\n\t\t",
                            start: 602,
                            end: 658,
                        },
                    },
                    FunctionCall {
                        callee: DotAccess {
                            expression: DotAccess {
                                expression: Identifier(
                                    Span {
                                        str: "this",
                                        start: 658,
                                        end: 662,
                                    },
                                ),
                                accessor: Identifier(
                                    Span {
                                        str: "connections",
                                        start: 663,
                                        end: 674,
                                    },
                                ),
                                span: Span {
                                    str: ".connections",
                                    start: 662,
                                    end: 674,
                                },
                            },
                            accessor: Identifier(
                                Span {
                                    str: "forEach",
                                    start: 675,
                                    end: 682,
                                },
                            ),
                            span: Span {
                                str: ".forEach",
                                start: 674,
                                end: 682,
                            },
                        },
                        generics: [],
                        arguments: [
                            Identifier(
                                Span {
                                    str: "call",
                                    start: 683,
                                    end: 687,
                                },
                            ),
                        ],
                        span: Span {
                            str: "(call)",
                            start: 682,
                            end: 688,
                        },
                    },
                ],
                span: Span {
                    str: "func fire() do\n\t\tfunc call(function: unknown) do\n\t\t\tfunction();\n\t\tend\n\n\t\tthis.connections.forEach(call);\n\tend\n",
                    start: 585,
                    end: 695,
                },
            },
        ],
        span: Span {
            str: "class Event\n\tname: string;\n\tfunctions: unknown[];\n\n\t#[constructor]\n\tfunc new(name: string) -> this do\n\t\tthis.name = name;\n\tend\n\n\tfunc connect(function: unknown) -> Connection do\n\t\tvar connection = Connection.new(this);\n\t\tthis.functions[this.functions.length + 1] = function;\n\n\t\treturn connection;\n\tend\n\n\tfunc _disconnect(id: int) do\n\t\tthis.connections.remove(id);\n\tend\n\n\tfunc fire() do\n\t\tfunc call(function: unknown) do\n\t\t\tfunction();\n\t\tend\n\n\t\tthis.connections.forEach(call);\n\tend\nend\n\n",
            start: 214,
            end: 700,
        },
    },
    VariableDefinition {
        name: Span {
            str: "event",
            start: 704,
            end: 709,
        },
        kind: Empty,
        value: FunctionCall {
            callee: DotAccess {
                expression: Identifier(
                    Span {
                        str: "Event",
                        start: 712,
                        end: 717,
                    },
                ),
                accessor: Identifier(
                    Span {
                        str: "new",
                        start: 718,
                        end: 721,
                    },
                ),
                span: Span {
                    str: ".new",
                    start: 717,
                    end: 721,
                },
            },
            generics: [],
            arguments: [
                String(
                    "Changed",
                    Span {
                        str: "\"Changed\"",
                        start: 722,
                        end: 731,
                    },
                ),
            ],
            span: Span {
                str: "(\"Changed\")",
                start: 721,
                end: 732,
            },
        },
        span: Span {
            str: "var event = Event.new(\"Changed\");",
            start: 700,
            end: 733,
        },
    },
    VariableDefinition {
        name: Span {
            str: "connection",
            start: 738,
            end: 748,
        },
        kind: Empty,
        value: FunctionCall {
            callee: DotAccess {
                expression: Identifier(
                    Span {
                        str: "event",
                        start: 751,
                        end: 756,
                    },
                ),
                accessor: Identifier(
                    Span {
                        str: "connect",
                        start: 757,
                        end: 764,
                    },
                ),
                span: Span {
                    str: ".connect",
                    start: 756,
                    end: 764,
                },
            },
            generics: [],
            arguments: [
                Identifier(
                    Span {
                        str: "onChanged",
                        start: 765,
                        end: 774,
                    },
                ),
            ],
            span: Span {
                str: "(onChanged)",
                start: 764,
                end: 775,
            },
        },
        span: Span {
            str: "var connection = event.connect(onChanged);",
            start: 734,
            end: 776,
        },
    },
    FunctionDefinition {
        name: Span {
            str: "onChanged",
            start: 783,
            end: 792,
        },
        generics: [],
        arguments: [],
        return_type: None,
        statements: [
            FunctionCall {
                callee: Identifier(
                    Span {
                        str: "print",
                        start: 799,
                        end: 804,
                    },
                ),
                generics: [],
                arguments: [
                    String(
                        "event fired",
                        Span {
                            str: "\"event fired\"",
                            start: 805,
                            end: 818,
                        },
                    ),
                ],
                span: Span {
                    str: "(\"event fired\")",
                    start: 804,
                    end: 819,
                },
            },
            FunctionCall {
                callee: DotAccess {
                    expression: Identifier(
                        Span {
                            str: "connection",
                            start: 822,
                            end: 832,
                        },
                    ),
                    accessor: Identifier(
                        Span {
                            str: "disconnect",
                            start: 833,
                            end: 843,
                        },
                    ),
                    span: Span {
                        str: ".disconnect",
                        start: 832,
                        end: 843,
                    },
                },
                generics: [],
                arguments: [],
                span: Span {
                    str: "()",
                    start: 843,
                    end: 845,
                },
            },
        ],
        span: Span {
            str: "func onChanged() do\n\tprint(\"event fired\");\n\tconnection.disconnect();\nend\n\n",
            start: 778,
            end: 852,
        },
    },
    FunctionCall {
        callee: DotAccess {
            expression: Identifier(
                Span {
                    str: "event",
                    start: 852,
                    end: 857,
                },
            ),
            accessor: Identifier(
                Span {
                    str: "fire",
                    start: 858,
                    end: 862,
                },
            ),
            span: Span {
                str: ".fire",
                start: 857,
                end: 862,
            },
        },
        generics: [],
        arguments: [],
        span: Span {
            str: "()",
            start: 862,
            end: 864,
        },
    },
    FunctionCall {
        callee: DotAccess {
            expression: Identifier(
                Span {
                    str: "event",
                    start: 866,
                    end: 871,
                },
            ),
            accessor: Identifier(
                Span {
                    str: "fire",
                    start: 872,
                    end: 876,
                },
            ),
            span: Span {
                str: ".fire",
                start: 871,
                end: 876,
            },
        },
        generics: [],
        arguments: [],
        span: Span {
            str: "()",
            start: 876,
            end: 878,
        },
    },
]